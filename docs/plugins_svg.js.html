<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>plugins/svg.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="jsPDF.html">jsPDF</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addFont">addFont</a></li><li><a href="global.html#addHTML">addHTML</a></li><li><a href="global.html#addMetadata">addMetadata</a></li><li><a href="global.html#addPage">addPage</a></li><li><a href="global.html#autoPrint">autoPrint</a></li><li><a href="global.html#CapJoinStyles">CapJoinStyles</a></li><li><a href="global.html#circle">circle</a></li><li><a href="global.html#ellipse">ellipse</a></li><li><a href="global.html#getFontList">getFontList</a></li><li><a href="global.html#lines">lines</a></li><li><a href="global.html#lstext">lstext</a></li><li><a href="global.html#output">output</a></li><li><a href="global.html#rect">rect</a></li><li><a href="global.html#roundedRect">roundedRect</a></li><li><a href="global.html#save">save</a></li><li><a href="global.html#setDisplayMode">setDisplayMode</a></li><li><a href="global.html#setDrawColor">setDrawColor</a></li><li><a href="global.html#setFillColor">setFillColor</a></li><li><a href="global.html#setFont">setFont</a></li><li><a href="global.html#setFontSize">setFontSize</a></li><li><a href="global.html#setFontStyle">setFontStyle</a></li><li><a href="global.html#setLineCap">setLineCap</a></li><li><a href="global.html#setLineJoin">setLineJoin</a></li><li><a href="global.html#setLineWidth">setLineWidth</a></li><li><a href="global.html#setPage">setPage</a></li><li><a href="global.html#setProperties">setProperties</a></li><li><a href="global.html#setTextColor">setTextColor</a></li><li><a href="global.html#svg">svg</a></li><li><a href="global.html#text">text</a></li><li><a href="global.html#triangle">triangle</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">plugins/svg.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @preserve
jsPDF svg plugin
Copyright (c) 2016 James Hall
MIT license.
*/
;(function (jsPDFAPI) {
  'use strict'

  // IE does not support outerHTML on SVGElement
  if (typeof SVGElement === 'object' &amp;&amp; !SVGElement.prototype.outerHTML) {
    Object.defineProperty(SVGElement.prototype, 'outerHTML', {
      get: function () {
        var $node
        var $temp
        $temp = document.createElement('div')
        $node = this.cloneNode(true)
        $temp.appendChild($node)
        return $temp.innerHTML
      },
      enumerable: false,
      configurable: true
    })
  }

  /**
   * @todo Remove duplication
   */
  function loadBinaryResource (url) {
    const req = new XMLHttpRequest()
    req.open('GET', url, false)
     // XHR binary charset opt by Marcus Granado 2006 [http://mgran.blogspot.com]
    req.overrideMimeType('text\/plain; charset=x-user-defined')
    req.send(null)
    if (req.status !== 200) {
      throw new Error('Unable to load file ' + url)
    }
    return req.responseText
  }

  /**
   * This is a cheap hack that inserts the SVG into a browser node to get it
   * to clean it up for us.
   * @param  {string} svg The SVG code
   * @return {object}     A DOM object
   */
  var domClean = function (svg) {
    var div = document.createElement('div');
    div.innerHTML = svg
    return div.querySelector('svg')
  }

  var getSvgFromInput = function (svg) {
    /**
     * If it's a string, then treat it as either raw SVG content
     */
    var svgContent
    if (typeof svg === 'string') {
      // If it's SVG
      if (svg.indexOf('&lt;svg') !== -1) {
        svgContent = domClean(svg)
      } else {
        // Otherwise it's a URL
        svgContent = domClean(loadBinaryResource(svg))
      }
    }

    if (typeof svg === 'object') {
      svgContent = svg
    }

    // Everything should be an object now
    svgContent = fixDimensions(svgContent)

    return svgContent.outerHTML
  }

  /**
   * Fix dimensions, if there's any 100%s in there that won't render
   * @todo Change that to the page size
   *
   * @param  {object} dom DOM node of an SVG
   * @return {object}     Fixed DOM node
   */
  var fixDimensions = function (dom) {
    if (dom.getAttributeNode('width').nodeValue == '100%') {
      var width = document.createAttribute('width')
      width.value = '10'
      dom.setAttributeNode(width)
    }
    if (dom.getAttributeNode('height').nodeValue == '100%') {
      var height = document.createAttribute('height')
      height.value = '10'
      dom.setAttributeNode(height)
    }
    return dom
  }

  /**
   * Render an SVG to the document.
   *
   * @param  {Mixed} svg      Pass either a DOM object, a string containing the
   * SVG content, or a path to the SVG you want to add.
   * @param  {Object} options Options are passed in as an object:
   * * x - The x position
   * * y - The y position
   * @return {jsPDF}
   * @function
   * @name svg
   * @example
   * var doc = new jsPDF()
   * doc.svg(document.querySelector('.svg'))
   *
   * // or to draw at a particular point on the page
   * doc.svg(document.querySelector('.svg'), { x: 10, y: 10 })
   *
   * // You can also draw SVG content directly
   * doc.svg(`&lt;svg width="120" height="120" viewBox="0 0 120 120"
   *  xmlns="http://www.w3.org/2000/svg">
   *  &lt;rect x="0" y="0" width="100" height="100"/>
   *  &lt;/svg>`, {
   *   x: 20,
   *   y: 20
   * })
   */
  jsPDFAPI.svg = function (svg, options) {
    var svgContent = getSvgFromInput(svg)

    if (typeof options === 'undefined') {
      options = {}
    }
    if (options.x === undefined) {
      options.x = 0
    }
    if (options.y === undefined) {
      options.y = 0
    }
    var c = this.canvas
    var ctx = c.getContext('2d')
    ctx.ignoreClearRect = true
    canvg(c, svgContent, {
      ignoreMouse: true,
      ignoreAnimation: true,
      ignoreDimensions: true,
      useCORS: true,
      offsetX: options.x,
      offsetY: options.y
    })
    return this
  }
})(jsPDF.API)
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Mon Sep 11 2017 12:02:25 GMT+0100 (BST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
